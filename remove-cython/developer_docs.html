
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="indigo">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Developer Documentation &#8212; pyMOR v2021.1rc0+298.gef41a10a Manual</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="shortcut icon" href="_static/pymor_favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="autoapi/index.html" />
    <link rel="prev" title="Bibliography" href="bibliography.html" />


  
   

<link rel="stylesheet" href="_static/pymor.css"/>
  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#developer_docs" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="pyMOR v2021.1rc0+298.gef41a10a Manual"
           class="md-header-nav__button md-logo">
          
              <img src="_static/pymor_logo_white.svg" height="26"
                   alt="pyMOR v2021.1rc0+298.gef41a10a Manual logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Documentation</span>
          <span class="md-header-nav__topic"> Developer Documentation </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "/versions.json",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">pyMOR v2021.1rc0+298.gef41a10a Manual</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="pyMOR v2021.1rc0+298.gef41a10a Manual" class="md-nav__button md-logo">
      
        <img src="_static/pymor_logo_white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="pyMOR v2021.1rc0+298.gef41a10a Manual">Documentation</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="getting_started.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="technical_overview.html" class="md-nav__link">Technical Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="environment.html" class="md-nav__link">Environment Variables</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tutorials.html" class="md-nav__link">pyMOR Tutorials</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release_notes/all.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="bibliography.html" class="md-nav__link">Bibliography</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Developer Documentation </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Developer Documentation</a>
      
        
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#setting-up-an-environment-for-pymor-development" class="md-nav__link">Setting up an Environment for pyMOR Development</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#getting-the-source" class="md-nav__link">Getting the source</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#environment-with-virtualenv" class="md-nav__link">Environment with Virtualenv</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#environment-with-docker-compose" class="md-nav__link">Environment with docker-compose</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#coding-guidelines-and-project-management" class="md-nav__link">Coding guidelines and project management</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#code-style" class="md-nav__link">Code style</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#github-project" class="md-nav__link">GitHub project</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#pre-commit-hooks" class="md-nav__link">pre-commit hooks</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#pymor-s-dependencies" class="md-nav__link">pyMOR’s dependencies</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#the-makefile" class="md-nav__link">The Makefile</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#the-env-file" class="md-nav__link">the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#continuous-testing-integration-setup" class="md-nav__link">Continuous Testing / Integration Setup</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#gitlab-ci" class="md-nav__link">Gitlab CI</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#stage-sanity" class="md-nav__link">Stage: Sanity</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stage-test" class="md-nav__link">Stage: Test</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stage-build" class="md-nav__link">Stage: Build</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stage-install-checks" class="md-nav__link">Stage: Install_checks</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stage-deploy" class="md-nav__link">Stage: Deploy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#github-gitlab-bridge" class="md-nav__link">Github - Gitlab bridge</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#github-actions" class="md-nav__link">GitHub Actions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#azure-pipelines" class="md-nav__link">Azure Pipelines</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#docker-images" class="md-nav__link">Docker images</a>
      
    
    </li></ul>
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="autoapi/index.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="autoapi/pymor/index.html" class="md-nav__link"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pymor</span></code></a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="developer-docs--page-root">Developer Documentation<a class="headerlink" href="#developer-docs--page-root" title="Permalink to this headline">¶</a></h1>

<h2 id="setting-up-an-environment-for-pymor-development">Setting up an Environment for pyMOR Development<a class="headerlink" href="#setting-up-an-environment-for-pymor-development" title="Permalink to this headline">¶</a></h2>

<h3 id="getting-the-source">Getting the source<a class="headerlink" href="#getting-the-source" title="Permalink to this headline">¶</a></h3>
<p>Clone the pyMOR git repository using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pymor</span><span class="o">/</span><span class="n">pymor</span> <span class="n">pymor_source</span>
<span class="n">cd</span> <span class="n">pymor_source</span>
</pre></div>
</div>
<p>and, optionally, switch to the branch you are interested in, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="mf">2020.2</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>


<h3 id="environment-with-virtualenv">Environment with Virtualenv<a class="headerlink" href="#environment-with-virtualenv" title="Permalink to this headline">¶</a></h3>
<p>Create and activate a new virtualenv:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">virtualenv</span> <span class="n">venv</span>
<span class="n">source</span> <span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>Then, make an editable installation of pyMOR with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span><span class="p">[</span><span class="n">full</span><span class="p">]</span>
</pre></div>
</div>


<h3 id="environment-with-docker-compose">Environment with docker-compose<a class="headerlink" href="#environment-with-docker-compose" title="Permalink to this headline">¶</a></h3>
<p>To get a shell in a preconfigured container run
(if required set <code class="docutils literal notranslate"><span class="pre">PYMOR_SUDO=1</span></code> in your environment to execute docker with elevated rights):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">docker_run</span>
</pre></div>
</div>
<p>You can also use the setup in <code class="docutils literal notranslate"><span class="pre">.binder/docker-compose.yml</span></code> to easily
work on pyMOR with <a class="reference external" href="https://www.jetbrains.com/help/pycharm/docker-compose.html">pyCharm</a>.</p>



<h2 id="coding-guidelines-and-project-management">Coding guidelines and project management<a class="headerlink" href="#coding-guidelines-and-project-management" title="Permalink to this headline">¶</a></h2>

<h3 id="code-style">Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h3>
<p>pyMOR follows the coding style of
<a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a> apart from a
few exceptions. Configurations for the <a class="reference external" href="https://pypi.python.org/pypi/pep8">PEP8</a> and
<a class="reference external" href="https://pypi.python.org/pypi/flake8">flake8</a> code checkers are contained in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>.</p>
<p>As an additional rule when calling functions, positional
arguments should generally be passed as positional arguments
whereas keyword arguments should be passed as keyword arguments.
This will make your code less likely to break, when the called
function is extended.</p>
<p>All functions and classes called or instantiated by users should
be sufficiently well documented.</p>


<h3 id="github-project">GitHub project<a class="headerlink" href="#github-project" title="Permalink to this headline">¶</a></h3>
<p>All new code enters pyMOR by means of a pull request. Pull requests (PR) trigger <a class="reference external" href="ref_section_ci">automatic tests</a>
which are mandatory to pass before the PR can be merged. A PR must also be tagged with either one of the
<code class="docutils literal notranslate"><span class="pre">pr:new-feature</span></code>, <code class="docutils literal notranslate"><span class="pre">pr:fix</span></code>, <code class="docutils literal notranslate"><span class="pre">pr:removal</span></code>, <code class="docutils literal notranslate"><span class="pre">pr:deprecation</span></code> or <code class="docutils literal notranslate"><span class="pre">pr:change</span></code> labels to clearly identify the type of
changes it introduces. See the <a class="reference external" href="https://github.com/pymor/pymor/labels?q=pr%3A">labels’ descriptions</a> for more details.</p>


<h3 id="pre-commit-hooks">pre-commit hooks<a class="headerlink" href="#pre-commit-hooks" title="Permalink to this headline">¶</a></h3>
<p>pyMOR ships a config for the <a class="reference external" href="https://pre-commit.com/">pre-commit</a> hook management system.
Using this setup can be a good way to find flake8 errors before pushing to GitHub, but using
it is not required. Once you have <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> installed in you environment, run</p>
<blockquote>
<div><p>pre-commit install</p>
</div></blockquote>
<p>Afterwards, the hooks configured in <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code> will run on all changed
files prior to committing changes. Errors will block the commit, some
checks will automatically fix the file.</p>



<h2 id="pymor-s-dependencies">pyMOR’s dependencies<a class="headerlink" href="#pymor-s-dependencies" title="Permalink to this headline">¶</a></h2>
<p>The single source of truth for our dependency setup is <code class="docutils literal notranslate"><span class="pre">dependencies.py</span></code>.
From it the <code class="docutils literal notranslate"><span class="pre">requirements*txt</span></code> files  and <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> are generated (by calling <code class="docutils literal notranslate"><span class="pre">make</span></code>).
During <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> execution <code class="docutils literal notranslate"><span class="pre">dependencies.py</span></code> is imported and the package lists passed to setuptools’s
<code class="docutils literal notranslate"><span class="pre">setup_requires</span></code>, <code class="docutils literal notranslate"><span class="pre">install_requires</span></code>, <code class="docutils literal notranslate"><span class="pre">tests_require</span></code> and <code class="docutils literal notranslate"><span class="pre">extra_requires</span></code> accordingly
(see <a class="reference internal" href="#ref-gitlab-ci-stage-test"><span class="std std-ref">this list</span></a>).
The <code class="docutils literal notranslate"><span class="pre">extra_requires</span></code> dictionary here controls what ‘extra’ configurations are available for
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pymor[extra1,extra2,extra3]</span></code>.</p>
<p>When adding new package dependencies, or version restrictions, these need to be reflected into
a commit in our docker repository for the <a class="reference external" href="https://github.com/pymor/docker/tree/main/constraints">constraints requirements</a>
so that updated images become available to CI after entering the new commit hash into <code class="docutils literal notranslate"><span class="pre">.env</span></code>.</p>


<span id="ref-makefile"></span><h2 id="the-makefile">The Makefile<a class="headerlink" href="#the-makefile" title="Permalink to this headline">¶</a></h2>
<p>Via the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> it is possible to execute tests close to how they are run on CI with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">docker_test</span></code>.
All jobs described in <a class="reference internal" href="#ref-gitlab-ci-stage-test"><span class="std std-ref">Gitlab CI Test Stage</span></a> can be run this way by setting <code class="docutils literal notranslate"><span class="pre">PYMOR_TEST_SCRIPT</span></code>
accordingly. You can pass additional arguments to pytest by setting <code class="docutils literal notranslate"><span class="pre">PYMOR_PYTEST_EXTRA</span></code>.
To run the test suite without docker,
simply execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> in the base directory of the pyMOR repository. This will
run the pytest suite with the default hypothesis profile “dev”. For available profiles
see <code class="docutils literal notranslate"><span class="pre">src/pymortests/conftest.py</span></code>. A profile is selected by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">PYMOR_HYPOTHESIS_PROFILE=PROFILE_NAME</span> <span class="pre">test</span></code>.
Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">full-test</span></code> to also enable
<a class="reference external" href="https://pypi.python.org/pypi/pyflakes">pyflakes</a> and <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">pep8</a> checks.</p>

<h3 id="the-env-file">the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file<a class="headerlink" href="#the-env-file" title="Permalink to this headline">¶</a></h3>
<p>This file records defaults used when executing CI scripts. These are loaded by make and can be
overridden like this: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">DOCKER_BASE_PYTHON=3.8</span> <span class="pre">docker_test</span></code> (see also the top of the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>).</p>



<span id="ref-section-ci"></span><h2 id="continuous-testing-integration-setup">Continuous Testing / Integration Setup<a class="headerlink" href="#continuous-testing-integration-setup" title="Permalink to this headline">¶</a></h2>
<p>Our CI infrastructure is spread across three major platforms. These are Gitlab CI (Linux testsuite),
Azure Pipelines (MacOS and Windows testsuite) and GitHub Actions (misc. checks).</p>
<p>pyMOR uses <code class="docutils literal notranslate"><span class="pre">pytest</span></code> &lt;<a class="reference external" href="https://pytest.org/">https://pytest.org/</a>&gt;`_ for unit testing.
All tests are contained within the <code class="docutils literal notranslate"><span class="pre">src/pymortests</span></code> directory and can be run
individually by executing <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">src/pymortests/the_module.py</span></code>.</p>

<span id="ref-gitlab-ci"></span><h3 id="gitlab-ci">Gitlab CI<a class="headerlink" href="#gitlab-ci" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Configured by <code class="docutils literal notranslate"><span class="pre">.ci/gitlab/ci.yml</span></code> which is generated from <code class="docutils literal notranslate"><span class="pre">.ci/gitlab/template.ci.py</span></code>
by the calling <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">template</span></code> (needs appropriate Python environment) or <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">docker_template</span></code>.</p>
</div>
<p>All stages are run in docker containers (<a class="reference internal" href="#ref-docker-images"><span class="std std-ref">more info</span></a>).
Jobs that potentially install packages get a frozen pypi mirror
as a “service” container. The mirror has a “oldest” variant in which all requirements are available
in the oldest versions that still satisfy all version restrictions (recursively checked).</p>

<span id="ref-gitlab-ci-stage-sanity"></span><h4 id="stage-sanity">Stage: Sanity<a class="headerlink" href="#stage-sanity" title="Permalink to this headline">¶</a></h4>
<p>A smoke test for the CI setup itself.
Checks if the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> can be processed and if all docker images needed by subsequent
stages are available in the <code class="docutils literal notranslate"><span class="pre">zivgitlab.wwu.io/pymor/docker/</span></code> registry.
Also ensures CI config and requirements generated from their templates match the committed files.</p>


<span id="ref-gitlab-ci-stage-test"></span><h4 id="stage-test">Stage: Test<a class="headerlink" href="#stage-test" title="Permalink to this headline">¶</a></h4>
<p>This stage executes <code class="docutils literal notranslate"><span class="pre">./.ci/gitlab/test_{{script}}.bash</span></code> for a list of different scripts:</p>
<dl class="simple">
<dt>vanilla</dt><dd><p>This runs plain <code class="docutils literal notranslate"><span class="pre">pytest</span></code> with the common options defined in <code class="docutils literal notranslate"><span class="pre">./.ci/gitlab/common_test_setup.bash</span></code>.</p>
</dd>
<dt>cpp_demo</dt><dd><p>Builds and executes the minimal cpp demo in <code class="docutils literal notranslate"><span class="pre">src/pymordemos/minimal_cpp_demo/</span></code>,
see also <a class="reference internal" href="tutorial_external_solver.html"><span class="doc">Tutorial: Binding an external PDE solver to pyMOR</span></a>.</p>
</dd>
<dt>mpi</dt><dd><p>Runs all demos with <code class="docutils literal notranslate"><span class="pre">mpirun</span> <span class="pre">-np</span> <span class="pre">2</span></code> via <code class="docutils literal notranslate"><span class="pre">src/pymortests/mpi_run_demo_tests.py</span></code>, checks against recorded results.</p>
</dd>
<dt>numpy_git</dt><dd><p>Same as vanilla, but against the unreleased numpy development branch. This makes sure we catch
deprecation warnings or breaking changes early.</p>
</dd>
<dt>oldest</dt><dd><p>Same as vanilla, but installs only packages from the “oldest” pypi mirror.</p>
</dd>
<dt>pip_installed</dt><dd><p>First install pyMOR from git over https, uninstall and then install with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.[full]</span></code>.
Uninstall again and install from a generated (and checked) sdist tarball. Lastly run the pytest suite
on the installed (!) pyMOR, not the git working tree.</p>
</dd>
<dt>tutorials</dt><dd><p>Using docutils magic this extracts the Python code from all the tutorials in
<code class="docutils literal notranslate"><span class="pre">docs/source/tutorials_*</span></code> (except tutorial_external_solver since that needs kernel switching)
and runs it in parameterized pytest fixtures as imported modules.</p>
</dd>
</dl>
<p>All scripts are executed for all Python versions that pyMOR currently supports, with the exception
of <code class="docutils literal notranslate"><span class="pre">numpy_git</span></code> and <code class="docutils literal notranslate"><span class="pre">oldest</span></code>. These are only tested against the newest and oldest versions accordingly.</p>


<span id="ref-gitlab-ci-stage-build"></span><h4 id="stage-build">Stage: Build<a class="headerlink" href="#stage-build" title="Permalink to this headline">¶</a></h4>
<p>Builds documentation and manylinux wheels on all supported pythons. Also builds and pushes
a docker image that includes pyMOR installed from checkout. This is used as the base image for the binder-ready
deployment of the documentation in the last stage.</p>


<span id="ref-gitlab-ci-stage-install"></span><h4 id="stage-install-checks">Stage: Install_checks<a class="headerlink" href="#stage-install-checks" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt>from wheel</dt><dd><p>Try to install wheels produced in previous stage on a few different Linuxs.</p>
</dd>
<dt>from source</dt><dd><p>Try to install <code class="docutils literal notranslate"><span class="pre">pymor[full]</span></code> from git checkout. This checks that the extension module compile works,
which is not covered by the “from wheel” step. Also install full optional requirements, which include
packages omitted from <code class="docutils literal notranslate"><span class="pre">[full]</span></code>, after necessary additional system package install.</p>
</dd>
<dt>local docker</dt><dd><p>Ensures minimal functionality for the local docker development setup .</p>
</dd>
</dl>


<span id="ref-gitlab-ci-stage-deploy"></span><h4 id="stage-deploy">Stage: Deploy<a class="headerlink" href="#stage-deploy" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt>docs</dt><dd><p>Commits documentation built in <a class="reference internal" href="#ref-gitlab-ci-stage-build"><span class="std std-ref">Stage: Build</span></a> (from a single Python version, not all) to the
<a class="reference external" href="https://github.com/pymor/docs">documentation repository</a>. This repository is the source for
<a class="reference external" href="https://docs.pymor.org/">https://docs.pymor.org/</a> served via GitHub Pages.
A binder setup for the generated tutorials notebooks is added on a branch with a name
matching the currently checked out git branch of pyMOR.</p>
</dd>
</dl>
<p>pypi</p>
<blockquote>
<div><p>Upload wheels to either the test or the real instance of the pypi repository, depending on whether
the pipeline runs for a tagged commit.</p>
</div></blockquote>
<dl class="simple">
<dt>coverage</dt><dd><p>This job accumulates all the coverage databases generated by previous stages and submits that
to <a class="reference external" href="https://codecov.io/github/pymor/pymor/">codecov.io</a>.</p>
</dd>
</dl>


<h4 id="github-gitlab-bridge">Github - Gitlab bridge<a class="headerlink" href="#github-gitlab-bridge" title="Permalink to this headline">¶</a></h4>
<p>This a sanic based Python <a class="reference external" href="https://github.com/pymor/ci_hooks_app">application</a> that receives webhook
events from GitHub for pull requests and pushes PR branches merged into main to Gitlab to run a
parallel CI pipeline to check whether the main branch will still pass tests after the PR is merged.
The bridge also does this for forks of pyMOR, but these have to be whitelisted in order to protect CI secrets.</p>



<h3 id="github-actions">GitHub Actions<a class="headerlink" href="#github-actions" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Configured by individual files in <code class="docutils literal notranslate"><span class="pre">.github/workflows/*</span></code></p>
</div>
<ul class="simple">
<li><p>Check all (external) links in changed Markdown documents are accessible.</p></li>
<li><p>Make sure at least one <code class="docutils literal notranslate"><span class="pre">pr:*</span></code> label is set on the PR.</p></li>
<li><p>Prohibit any commits with messages that indicate they can be auto-squashed</p></li>
<li><p>Auto-assign the labels if certain files are changed by the PR.</p></li>
</ul>


<h3 id="azure-pipelines">Azure Pipelines<a class="headerlink" href="#azure-pipelines" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Configured by <code class="docutils literal notranslate"><span class="pre">.ci/azure/pipeline-{osx,win}.yml</span></code> respectively.</p>
</div>
<p>Setup test environments with conda and run pytest. Also generate and upload coverage reports.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">.ci/azure/pymor_defaults.py_*</span></code> may override defaults</p>
</div>


<span id="ref-docker-images"></span><h3 id="docker-images">Docker images<a class="headerlink" href="#docker-images" title="Permalink to this headline">¶</a></h3>
<p>The source for most of our docker images is this <a class="reference external" href="https://github.com/pymor/docker">repository</a>.
The images are build by a Makefile system that expresses dependencies, handles parameterization,
preloads caching and so forth. Builds are only permitted on a clean working tree, to increase reproducibility.
On each push <a class="reference external" href="https://zivgitlab.uni-muenster.de/pymor/docker/-/pipelines">GitLab CI</a> builds the entire tree.
Great effort went into making incremental updates as fast as possible, but full rebuilds will take upwards of 3 hours.
There are two basic categories for images: those that get generated for each supported Python version and those that
are version independent.
For CI the main image, in which the pytest suite runs, is defined in <code class="docutils literal notranslate"><span class="pre">testing/</span></code>. The main workflow for this repository
is adding new packages to the appropriate requirements file in the <code class="docutils literal notranslate"><span class="pre">constraints/</span></code> subdir. From there
those packages will become available in the <code class="docutils literal notranslate"><span class="pre">pypi_mirror-*</span></code> images, but also pre-installed in the <code class="docutils literal notranslate"><span class="pre">testing</span></code> image.</p>





          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="bibliography.html" title="Bibliography"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Bibliography </span>
              </div>
            </a>
          
          
            <a href="autoapi/index.html" title="API Reference"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> API Reference </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2013-2021 pyMOR developers and contributors.
              
          </div>
            Last updated on
              May 20, 2021.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>